{% extends 'cyWebsite/base.html' %}
{% load static %}
{% block content %}
<div class="container mt-5">
    <h1 class="text-center">Mon Profil</h1>
    <div class="card shadow mt-4">
        <div class="card-body">
            <div class="text-center">
                <img src="{% if user.profile_picture %}{{ user.profile_picture.url }}{% else %}{% static 'default_profile.png' %}{% endif %}" 
                     alt="Photo de profil" class="rounded-circle" style="width: 150px; height: 150px; cursor: pointer;"
                     data-toggle="modal" data-target="#changeProfilePictureModal">
            </div>
            <h3 class="text-center mt-3">{{ user.username }}</h3>
            <p class="text-center text-muted">{{ user.email }}</p>
            <hr>
            <p><strong>Nom complet :</strong> {{ user.first_name }} {{ user.last_name }}</p>
            <p><strong>Date d'inscription :</strong> {{ user.date_joined|date:"d/m/Y" }}</p>
            <p><strong>Niveau d'XP :</strong> {{ user.get_xp_level_display }}</p>
        </div>
    </div>
</div>

<!-- Modal pour changer la photo de profil -->
<div class="modal fade" id="changeProfilePictureModal" tabindex="-1" role="dialog" aria-labelledby="changeProfilePictureModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="changeProfilePictureModalLabel">Changer la photo de profil</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form method="post" enctype="multipart/form-data" action="{% url 'user:update_profile_picture' %}">
                {% csrf_token %}
                <div class="modal-body">
                    <div class="form-group">
                        <label for="id_profile_picture">Nouvelle photo de profil :</label>
                        {{ form.profile_picture }}
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Annuler</button>
                    <button type="submit" class="btn btn-primary">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}